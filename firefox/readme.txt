Majority of this is stolen from https://github.com/seirin-blu/Firefox-Halo/tree/master

At least originally based on v5.1.1